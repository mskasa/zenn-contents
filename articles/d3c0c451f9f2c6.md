---
title: "AWS SAP対策 S3編"
emoji: "✏️"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [aws, s3]
published: false
---

## S3ストレージクラス早見表

| ストレージクラス                             | アクセス頻度 | データ取得時間 | データの重要度 | 
| -------------------------------------------- | ------------ | -------------- | ------ | 
| 標準（Standard）                             | 高い         | ミリ秒         | 高い   | 
| 標準-低頻度アクセス（Standard-IA）           | 低い         | ミリ秒         | 高い   | 
| 1ゾーン-低頻度アクセス（One Zone-IA）        | 低い         | ミリ秒         | 低い   | 
| Intelligent-Tiering                          | 変動する     | ミリ秒         | 高い   | 
| Glacier Instant Retrieval                    | ほぼない     | ミリ秒         | 高い   | 
| Glacier Flexible Retrieval（旧 S3 Glacier）  | ほぼない     | 1分〜12時間    | 高い   | 
| Glacier Deep Archive                         | ほぼない     | 12〜48 時間    | 高い   | 

https://aws.amazon.com/jp/s3/storage-classes/

:::message
* 保存するデータの重要度が「低い」場合は1ゾーン一択
* アクセス頻度は標準、IA、Glacierの3段階
* Glacierはデータ取得時間で3つのタイプに分かれる（細かな数字も覚えておく）
* Intelligent-Tieringについては後述する
:::

## S3の料金

S3の料金は、下記で構成される。

1年間のストレージ料金 + リクエスト料金 + データ取り出し料金 + データ転送料金

S3のクラスによって、3要素の単価が異なるため、データ特性にあったストレージクラスを選ぶことがコスト削減につながる。

:::message
データ転送料金はS3のクラスによって変動しないため、試験で取り上げられることはないはず
:::

https://aws.amazon.com/jp/s3/pricing/

### Intelligent-Tiering

Intelligent-Tieringは、アクセス頻度によって、オブジェクトを自動で階層分けしてくれるストレージクラス。
30日間リクエストのないオブジェクトが自動で、低頻度アクセス階層へ移動する。逆に、リクエストがあると、高頻度アクセス階層へ移動する。
つまり、アクセス頻度が変化する場合や、予測できない場合にコスト効率がよくなる可能性がある。

:::message
* 別途、モニタリングコストとしてオブジェクト 1,000 件あたり 0.0025USD 発生する
  * 試験で問われることは恐らく無いが、実務でS3のクラス選択をする際には念頭に置いておく
:::

### S3リクエスタ支払い

S3料金のうち、リクエスト料金とデータ転送料金をリクエストした側のアカウントに請求する設定のこと。
有効にした場合、AWSアカウント以外からのアクセスができなくなる。
リクエストする側は、課金されることを了承している旨を示すため、リクエストのヘッダーに`x-amz-request-payer`を含める必要がある。
