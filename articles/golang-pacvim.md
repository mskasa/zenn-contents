---
title: "Vimã‚³ãƒãƒ³ãƒ‰ã§ãƒ‘ãƒƒã‚¯ãƒãƒ³ã‚’éŠã¶ï¼Vimå­¦ç¿’ã‚²ãƒ¼ãƒ ã‚’Goã§ä½œã£ã¦ã¿ãŸğŸ‘"
emoji: "ğŸ˜¶"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [go, vim, ã‚²ãƒ¼ãƒ , å€‹äººé–‹ç™º]
published: true
published_at: 2023-08-28 07:00
---

![pacvim](https://github.com/masahiro-kasatani/pacvim/blob/readme-images/files/readme.png?raw=true)
_The Go gopher was designed by RenÃ©e French._

https://github.com/masahiro-kasatani/pacvim

## æ¦‚è¦

å€‹äººé–‹ç™ºã®å®£ä¼è¨˜äº‹ã«ãªã‚Šã¾ã™ã€‚
ã‚¿ã‚¤ãƒˆãƒ«ã®é€šã‚Šã€ãƒ‘ãƒƒã‚¯ãƒãƒ³ã‚’ Vim ã‚³ãƒãƒ³ãƒ‰ã§æ“ä½œã™ã‚‹ã‚²ãƒ¼ãƒ ã‚’ Go ã§ä½œã£ã¦ã¿ã¾ã—ãŸã€‚

ä¸‹è¨˜ãŒæœ¬è¨˜äº‹ã®å¯¾è±¡èª­è€…ã§ã™ã€‚

- Vim æ“ä½œã‚’æ¥½ã—ãç·´ç¿’ã—ãŸã„æ–¹
- Go ã§ä½•ã‹ã‚’ä½œã£ã¦ã¿ãŸã„æ–¹

## PacVim ã‚’éŠã³ãŸã„æ–¹ã¸

### PacVim ã®èµ·å‹•æ–¹æ³•

- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

```sh
git clone https://github.com/masahiro-kasatani/pacvim.git
```

- èµ·å‹•
  - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸä¸­ã«ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ã®ã§ã€ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§èµ·å‹•ã—ã¦ãã ã•ã„
    - Windows ã®å ´åˆï¼š[pacvim/bin/win/pacvim.exe](https://github.com/masahiro-kasatani/pacvim/tree/master/bin/win)
    - Mac ã®å ´åˆï¼š[pacvim/bin/mac/pacvim](https://github.com/masahiro-kasatani/pacvim/tree/master/bin/mac)

### PacVim ã®ãƒ«ãƒ¼ãƒ«

PacVim ã¯ãƒ‘ãƒƒã‚¯ãƒãƒ³ã®ãƒ«ãƒ¼ãƒ«ã‚’è¸è¥²ã—ã¦ã„ã¾ã™ã€‚

#### ã‚²ãƒ¼ãƒ ç”»é¢

![ã‚²ãƒ¼ãƒ ç”»é¢](https://raw.githubusercontent.com/masahiro-kasatani/pacvim/readme-images/files/screen.png)

:::message
ç›®ãŒãƒã‚«ãƒã‚«ã™ã‚‹ã®ã§ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚„ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’æ‹¡å¤§è¡¨ç¤ºã—ã¦éŠã¶ã“ã¨ã‚’ã‚ªã‚¹ã‚¹ãƒ¡ã—ã¾ã™ã€‚
:::

#### ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦

| ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå |                                                                                                                                                     è¡¨ç¤ºã€€ã€€ã€€ã€€                                                                                                                                                     | è£œè¶³èª¬æ˜                     |
| :------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: | :--------------------------- |
| ã‚Šã‚“ã”         |                                               ![ã‚Šã‚“ã”ï¼ˆæœªï¼‰](https://raw.githubusercontent.com/masahiro-kasatani/pacvim/readme-images/files/apple_1.png) ![ã‚Šã‚“ã”ï¼ˆæ¸ˆï¼‰](https://raw.githubusercontent.com/masahiro-kasatani/pacvim/readme-images/files/apple_2.png)                                                | é£Ÿã¹ã‚‹ã¨ç·‘è‰²ã«ãªã‚Šã¾ã™       |
| æ¯’             |                                                                                                           ![æ¯’](https://raw.githubusercontent.com/masahiro-kasatani/pacvim/readme-images/files/poison.png)                                                                                                           | -                            |
| éšœå®³ç‰©         | ![éšœå®³ç‰©ï¼‘](https://raw.githubusercontent.com/masahiro-kasatani/pacvim/readme-images/files/wall_1.png) ![éšœå®³ç‰©ï¼’](https://raw.githubusercontent.com/masahiro-kasatani/pacvim/readme-images/files/wall_2.png) ![éšœå®³ç‰©ï¼“](https://raw.githubusercontent.com/masahiro-kasatani/pacvim/readme-images/files/wall_3.png) | -                            |
| ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼     |                                                                                                       ![ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼](https://raw.githubusercontent.com/masahiro-kasatani/pacvim/readme-images/files/player.png)                                                                                                       | -                            |
| æ•µï¼ˆãƒãƒ³ã‚¿ãƒ¼ï¼‰ |                                                                                                        ![ãƒãƒ³ã‚¿ãƒ¼](https://raw.githubusercontent.com/masahiro-kasatani/pacvim/readme-images/files/hunter.png)                                                                                                        | -                            |
| æ•µï¼ˆã‚´ãƒ¼ã‚¹ãƒˆï¼‰ |                                                                                                        ![ã‚´ãƒ¼ã‚¹ãƒˆ](https://raw.githubusercontent.com/masahiro-kasatani/pacvim/readme-images/files/ghost.png)                                                                                                         | éšœå®³ç‰©ã‚’ã™ã‚ŠæŠœã‘ã‚‰ã‚Œã‚‹æ•µã§ã™ |

#### ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ã«ã¤ã„ã¦

| çŠ¶æ…‹           | é·ç§»æ¡ä»¶                            |
| :------------- | :---------------------------------- |
| ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢ | ã™ã¹ã¦ã®ã‚Šã‚“ã”ã‚’é£Ÿã¹ã‚‹              |
| ã‚¹ãƒ†ãƒ¼ã‚¸å¤±æ•—   | æ•µã«æ•ã¾ã‚‹ or æ¯’ã‚’é£Ÿã¹ã‚‹            |
| ã‚²ãƒ¼ãƒ ã‚¯ãƒªã‚¢   | ã™ã¹ã¦ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹        |
| ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ | ãƒ©ã‚¤ãƒ•ãŒ 0 ã®çŠ¶æ…‹ã§ã‚¹ãƒ†ãƒ¼ã‚¸å¤±æ•—ã™ã‚‹ |

### ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ“ä½œæ–¹æ³•

|   ã‚­ãƒ¼    | å‹•ä½œç¨®åˆ¥ | å‹•ä½œ                                                   |
| :-------: | :------- | :----------------------------------------------------- |
| `h`, `Nh` | `walk`   | å·¦ã¸ 1 ãƒã‚¹ç§»å‹•ã™ã‚‹ï¼ˆ`Nh` ã®å ´åˆã¯ N å›ç¹°ã‚Šè¿”ã™ï¼‰      |
| `j`, `Nj` | `walk`   | ä¸‹ã¸ 1 ãƒã‚¹ç§»å‹•ã™ã‚‹ï¼ˆ`Nj` ã®å ´åˆã¯ N å›ç¹°ã‚Šè¿”ã™ï¼‰      |
| `k`, `Nk` | `walk`   | ä¸Šã¸ 1 ãƒã‚¹ç§»å‹•ã™ã‚‹ï¼ˆ`Nk` ã®å ´åˆã¯ N å›ç¹°ã‚Šè¿”ã™ï¼‰      |
| `l`, `Nl` | `walk`   | å³ã¸ 1 ãƒã‚¹ç§»å‹•ã™ã‚‹ï¼ˆ`Nl` ã®å ´åˆã¯ N å›ç¹°ã‚Šè¿”ã™ï¼‰      |
| `w`, `Nw` | `walk`   | æ¬¡ã®å˜èªã®å…ˆé ­ã«ç§»å‹•ã™ã‚‹ï¼ˆ`Nw` ã®å ´åˆã¯ N å›ç¹°ã‚Šè¿”ã™ï¼‰ |
| `e`, `Ne` | `walk`   | æ¬¡ã®å˜èªã®æœ«å°¾ã«ç§»å‹•ã™ã‚‹ï¼ˆ`Ne` ã®å ´åˆã¯ N å›ç¹°ã‚Šè¿”ã™ï¼‰ |
| `b`, `Nb` | `walk`   | å‰ã®å˜èªã®å…ˆé ­ã«ç§»å‹•ã™ã‚‹ï¼ˆ`Nb` ã®å ´åˆã¯ N å›ç¹°ã‚Šè¿”ã™ï¼‰ |
|    `0`    | `jump`   | ç¾åœ¨ã®è¡Œã®å…ˆé ­ã«ç§»å‹•ã™ã‚‹                               |
|    `$`    | `jump`   | ç¾åœ¨ã®è¡Œã®æœ«å°¾ã«ç§»å‹•ã™ã‚‹                               |
|    `^`    | `jump`   | ç¾åœ¨ã®è¡Œã®æœ€åˆã®å˜èªã®å…ˆé ­ã«ç§»å‹•ã™ã‚‹                   |
|   `gg`    | `jump`   | æœ€åˆã®è¡Œã®æœ€åˆã®å˜èªã®å…ˆé ­ã«ç§»å‹•ã™ã‚‹                   |
|    `G`    | `jump`   | æœ€å¾Œã®è¡Œã®æœ€åˆã®å˜èªã®å…ˆé ­ã«ç§»å‹•ã™ã‚‹                   |
|   `NG`    | `jump`   | N è¡Œç›®ã®è¡Œã®æœ€åˆã®å˜èªã®å…ˆé ­ã«ç§»å‹•ã™ã‚‹                 |
|    `q`    | -        | ã‚²ãƒ¼ãƒ ã‚’ã‚„ã‚ã‚‹                                         |

#### å‹•ä½œç¨®åˆ¥ã«ã¤ã„ã¦

- `walk`

  - `walk` ã¯ç›®çš„åœ°ã¾ã§ã€ 1 ãƒã‚¹ãšã¤ä¸€ç¬ã§ç§»å‹•ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚ãã®ãŸã‚ã€æ•µã‚„éšœå®³ç‰©ã€ã‚Šã‚“ã”ã¨ã®å½“ãŸã‚Šåˆ¤å®šãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚ä¸€æ°—ã«ã‚Šã‚“ã”ã‚’é£Ÿã¹ãŸã„ã¨ãã«ä½¿ã„ã¾ã—ã‚‡ã†ã€‚

    - ä¾‹ï¼š `w` ã‚’å…¥åŠ›ã—ãŸå ´åˆ

      ![walkã®ä¾‹](https://raw.githubusercontent.com/masahiro-kasatani/pacvim/readme-images/files/readme-w.gif)

- `jump`

  - `jump` ã¯ç›®çš„åœ°ã¾ã§ã€é–“ã‚’é£›ã³è¶Šãˆã¦ä¸€ç¬ã§åˆ°é”ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚ãã®ãŸã‚ã€æ•µã‚„éšœå®³ç‰©ã€ã‚Šã‚“ã”ã¨ã®å½“ãŸã‚Šåˆ¤å®šãŒé©ç”¨ã•ã‚Œã¾ã›ã‚“ã€‚æ•µã‚„éšœå®³ç‰©ã‚’é¿ã‘ã¦ç§»å‹•ã—ãŸã„ã¨ãã«ä½¿ã„ã¾ã—ã‚‡ã†ã€‚

    - ä¾‹ï¼š `$` ã‚’å…¥åŠ›ã—ãŸå ´åˆ

      ![jumpã®ä¾‹](https://raw.githubusercontent.com/masahiro-kasatani/pacvim/readme-images/files/readme-doller.gif)

## PacVim ã‚’é–‹ç™ºã—ãŸã„æ–¹ã¸

### é–‹ç™ºç”¨ã‚³ãƒãƒ³ãƒ‰

```sh
make help
Usage:
    make <command>

Commands:
    fmt
        go fmt
    lint
        golangci-lint run
    deps
        go mod tidy
    test
        go test
    cover
        create cover.html
    build
        Make a macOS executable binary
    build-win
        Make a Windows executable binary
    clean
        Remove binary files
```

:::message
make ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãªã„å ´åˆã€[Makefile](https://github.com/masahiro-kasatani/pacvim/blob/master/Makefile) ã‚’å‚è€ƒã«ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

- ä¾‹ï¼šMacOS ã§ãƒ“ãƒ«ãƒ‰ã‚’ã™ã‚‹å ´åˆ
  - `go build -o bin/mac/pacvim .`

:::

### å®Ÿè¡Œç”¨ã‚ªãƒ—ã‚·ãƒ§ãƒ³

```sh
./pacvim -h
Usage of ./pacvim:
  -level int
    	Level at the start of the game. (default 1)
  -life int
    	Remaining lives. (default 2)
```

- ä¾‹ï¼šæ®‹æ©Ÿ 5 ã§ãƒ¬ãƒ™ãƒ« 3 ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã—ãŸã„å ´åˆ
  - `go run . -level 3 -life 5`

### PacVim ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ–¹æ³•

ãã‚Œãã‚Œã‚³ãƒŸãƒƒãƒˆä¾‹ã‚’ä½œæˆã—ãŸã®ã§ã€å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

#### ã‚¹ãƒ†ãƒ¼ã‚¸ãƒãƒƒãƒ—ã®è¿½åŠ æ–¹æ³•

https://github.com/masahiro-kasatani/pacvim/commit/ab3afdd377e3ac83e0b05b279096f3bcbdd5a26f

#### æ•µã®ç¨®é¡ã®è¿½åŠ æ–¹æ³•

https://github.com/masahiro-kasatani/pacvim/commit/6c5f88a32b7ffe73bd640717f0470407578c65d0

#### æ•µã®æˆ¦ç•¥ã®è¿½åŠ æ–¹æ³•

https://github.com/masahiro-kasatani/pacvim/commit/b0f405ff0be4dc3143579536f89aa30c83c608b6

## PacVim å®Ÿè£… Tips

ã“ã“ã‹ã‚‰ã¯ã€PacVim ã‚’å®Ÿè£…ã™ã‚‹ä¸Šã§å·¥å¤«ã—ãŸç‚¹ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

### é«˜éšé–¢æ•°

Go ã§ã¯ã€é–¢æ•°ã¯ç¬¬ä¸€ç´šé–¢æ•°ã§ã‚ã‚‹ãŸã‚ã€é«˜éšé–¢æ•°ï¼ˆé–¢æ•°ãŒå¼•æ•°ã¨ã—ã¦é–¢æ•°ã‚’å–ã£ãŸã‚Šã€é–¢æ•°ã‚’è¿”ã—ãŸã‚Šã™ã‚‹ã“ã¨ï¼‰ã‚’å®Ÿè£…ã§ãã¾ã™ã€‚ã“ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’ä»Šå›ã¯ä¸»ã« switch æ–‡ã®å¯èª­æ€§ã®å‘ä¸Šã‚„ã€é‡è¤‡å‡¦ç†ã®å…±é€šåŒ–ã®ãŸã‚ã«åˆ©ç”¨ã—ã¾ã—ãŸã€‚
ä»¥ä¸‹ã«ç¤ºã™é€šã‚Šã€ã‚­ãƒ¼å…¥åŠ›ã«å¯¾ã™ã‚‹æŒ™å‹•ãŒä¸€è¡Œã§ç°¡æ½”ã«æ›¸ã‘ã¦ã„ã¾ã™ã€‚ãŠã‹ã’ã•ã¾ã§ [gocyclo](https://goreportcard.com/report/github.com/masahiro-kasatani/pacvim#gocyclo) ã‚‚ 100%ã‚’ç¶­æŒã§ãã¾ã—ãŸã€‚

- æŠœç²‹

```go:player.go
func (p *player) action(ch rune, s stage) {
	switch ch {
	case 'w':
		p.moveByWord(p.toBeginningOfNextWord)
	case 'b':
		p.moveByWord(p.toBeginningPrevWord)
	case 'e':
		p.moveByWord(p.toEndOfCurrentWord)
	case '0':
		p.jumpOnCurrentLine(p.toLeftEdge)
	case '$':
		p.jumpOnCurrentLine(p.toRightEdge)
	case '^':
		p.jumpOnCurrentLine(p.toBeginningOfFirstWord)
	case 'g':
		p.jumpAcrossLine(p.toFirstLine, s, ch)
	case 'G':
		p.jumpAcrossLine(p.toLastLine, s, ch)
	}
}

func (p *player) moveByWord(fn func() bool) {
	if p.inputNum != 0 && p.inputG {
		p.initInput()
		fn()
	} else if p.inputNum != 0 {
		for i := 0; i < p.inputNum; i++ {
			if !fn() {
				break
			}
		}
	} else {
		fn()
	}
	p.initInput()
}

func (p *player) jumpOnCurrentLine(fn func()) {
	fn()
	p.judgeMoveResult()
	p.initInput()
}

func (p *player) jumpAcrossLine(fn func(stage), s stage, ch rune) {
	if ch == 'g' && !p.inputG {
		p.inputG = true
	} else if ch == 'G' || (ch == 'g' && p.inputG) {
		if p.inputNum == 0 {
			fn(s)
		} else {
			p.toSelectedLine(s)
		}
		p.judgeMoveResult()
		p.initInput()
	}
}
```

- `player.go`å…¨æ–‡

https://github.com/masahiro-kasatani/pacvim/blob/master/player.go

### ãƒ“ãƒ«ãƒ€ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³

æ•µã®ç”Ÿæˆã«ã¯ãƒ“ãƒ«ãƒ€ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¡ç”¨ã—ã¾ã—ãŸã€‚æ§‹é€ ä½“`enemy`ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ•°ãŒå¤šãã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°ï¼ˆãƒ•ã‚¡ã‚¯ãƒˆãƒªé–¢æ•°ï¼‰ã§ã¯å¯èª­æ€§ã¨æ‹¡å¼µæ€§ã«å•é¡ŒãŒã‚ã‚‹ã¨åˆ¤æ–­ã—ãŸãŸã‚ã§ã™ã€‚

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æ•µã‚’ä½œã‚ŠãŸã„å ´åˆã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå½¢ã§ã™ã€‚éå¸¸ã«åˆ†ã‹ã‚Šã‚„ã™ã„ã§ã™ã­ã€‚

```go
hunter := newEnemyBuilder().defaultHunter().build()
ghost := newEnemyBuilder().defaultGhost().build()
```

è¨­å®šå€¤ã‚’ã‚¤ã‚¸ã‚ŠãŸã„å ´åˆã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå½¢ã§ã™ã€‚ã“ã‚Œã‚‚ç›´æ„Ÿçš„ã§ã™ã­ã€‚

```go
hunter := newEnemyBuilder().defaultHunter().speed(2).build()
ghost := newEnemyBuilder().defaultGhost().strategize(&assault{}).build()
```

æä¾›å´ï¼ˆ`enemy.go`ï¼‰ã¯ã‚³ãƒ¼ãƒ‰é‡ãŒå¢—ãˆã¦å°‘ã€…è¤‡é›‘ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ãŒã€åˆ©ç”¨å´ã¯ä¸Šè¨˜ã®ã‚ˆã†ã«å¯èª­æ€§ã«å„ªã‚ŒãŸã‚·ãƒ³ãƒ—ãƒ«ãªã‚³ãƒ¼ãƒ‰ã«ãªã‚Šã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚²ãƒ¼ãƒ ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ã“ã¨ã‚‚æƒ³å®šã—ã€ã“ã¡ã‚‰ã®æ–¹ãŒè‰¯ã„ã¨åˆ¤æ–­ã—ã¾ã—ãŸã€‚

### ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³

æ•µã®æˆ¦ç•¥ã«ã¯ãã®åã®é€šã‚Šã€ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã®åŸ‹ã‚è¾¼ã¿ï¼‰ã‚’æ¡ç”¨ã—ã¾ã—ãŸã€‚ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®åˆ‡ã‚Šæ›¿ãˆã‚’ç°¡å˜ã«ã—ã¾ã™ã€‚è¦ã¯ãƒãƒªãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ ï¼ˆå¤šæ…‹æ€§ï¼‰ã®å®Ÿè£…ã§ã™ã­ã€‚
åŒã˜`enemy`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚‚ã€ç¨®é¡ï¼ˆ`hunter`ã‹`ghost`ã‹ï¼‰ã‚„æˆ¦ç•¥ï¼ˆ`assault`ã‹`tricky`ã‹ï¼‰ã§æŒ¯ã‚‹èˆã„ãŒç•°ãªã‚Šã¾ã™ã€‚
ä»Šå›ã€ç¨®é¡ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®é•ã„ã‚’é–¢æ•°`canMove`ã®åŸ‹ã‚è¾¼ã¿ã€æˆ¦ç•¥ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®é•ã„ã‚’ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹`strategy`ã®åŸ‹ã‚è¾¼ã¿ã§å®Ÿè£…ã—ã¾ã—ãŸã€‚

- æŠœç²‹

```go:enemy.go
type enemy struct {
	x            int
	y            int
	char         rune
	color        termbox.Attribute
	waitingTime  int
	oneActionInN int
	canMove      func(int, int) bool
	strategy
	underRune
}

type strategy interface {
	eval(p *player, x, y int) float64
}
type assault struct{}
type tricky struct{}

func (e *enemy) eval(p *player, x, y int) float64 {
	if !e.canMove(x, y) {
		// Returns a large enough value if it can't move
		return 1000
	}
	return e.strategy.eval(p, x, y)
}
func (s *assault) eval(p *player, x, y int) float64 {
	// Distance between two points
	return math.Sqrt(math.Pow(float64(p.y-y), 2) + math.Pow(float64(p.x-x), 2))
}
func (s *tricky) eval(p *player, x, y int) float64 {
	if random(0, 5) == 0 {
		return float64(random(0, 30))
	} else {
		return math.Sqrt(math.Pow(float64(p.y-y), 2) + math.Pow(float64(p.x-x), 2))
	}
}
```

- `enemy.go`å…¨æ–‡

https://github.com/masahiro-kasatani/pacvim/blob/master/enemy.go

## æ‰€æ„Ÿ

ã‚´ãƒ«ãƒ¼ãƒãƒ³ã®å‹‰å¼·ã®ãŸã‚ã«ä½œã‚Šå§‹ã‚ã¾ã—ãŸãŒã€æ°—ã¥ã‘ã°ä¸­ã€…ã®ãƒœãƒªãƒ¥ãƒ¼ãƒ ã«ãªã£ãŸã®ã§å…¬é–‹ + å®£ä¼ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸã€‚æ•µã®æ€è€ƒãƒ­ã‚¸ãƒƒã‚¯ã¨ã‹ã¯å°‚é–€å¤–ãªã®ã§çªãè©°ã‚ã‚‰ã‚Œã¾ã›ã‚“ã§ã—ãŸãŒã€å–ã‚Šæ•¢ãˆãšå‹•ãã‚‚ã®ãŒå‡ºæ¥ãŸã®ã§æº€è¶³ã—ã¦ã„ã¾ã™ã€‚

ä»¥ä¸Šã§ã™ã€‚

## å‚è€ƒ

- C++ç‰ˆ PacVim

https://github.com/jmoon018/PacVim
